{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import\"../assets/css/Category_genre_filter.css\";import{isTokenValid}from'./Auth';/**\n * FilterReviews Component\n * \n * This component displays a list of categories and their associated genres, allowing users to filter reviews by category or genre.\n * It includes functionality to toggle genre dropdown menus for each category and navigate to filtered review pages.\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FilterReviews=()=>{const[categories,setCategories]=useState([]);// Stores category data\nconst[genresByCategory,setGenresByCategory]=useState({});// Stores genres organized by category\nconst navigate=useNavigate();const[dropdownOpen,setDropdownOpen]=useState(null);// Stores the ID of the currently open dropdown or null if none\n// Fetch categories and genres on component mount\nuseEffect(()=>{// Redirect to login if the token is invalid\nif(!isTokenValid()){navigate('/api/login/');return;}const token=localStorage.getItem('token');// Async function to fetch categories and associated genres\nconst fetchCategoriesAndGenres=async()=>{try{// Fetch categories\nconst categoriesResponse=await axios.get('/categories/',{headers:{'Authorization':`Bearer ${token}`}});const categoriesData=categoriesResponse.data;setCategories(categoriesData);// Fetch genres for each category\nconst genresData={};for(const category of categoriesData){const genresResponse=await axios.get(`/categories/${category.id}/genres/`,{headers:{'Authorization':`Bearer ${token}`}});genresData[category.id]=genresResponse.data;}setGenresByCategory(genresData);}catch(error){console.error('Error fetching categories and genres:',error);// Log errors for debugging\n}};fetchCategoriesAndGenres();},[navigate]);// Navigate to the category page\nconst handleCategoryClick=categoryId=>{navigate(`/reviews/category/${categoryId}`);};// Navigate to the genre page\nconst handleGenreClick=genreId=>{navigate(`/reviews/genre/${genreId}`);};// Toggle dropdown for genre list visibility\nconst toggleDropdown=categoryId=>{setDropdownOpen(prevOpenId=>prevOpenId===categoryId?null:categoryId);};return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-secondary rounded p-3 text-center bk-color\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Categories\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"dropdown-list mt-3\",children:categories.map(category=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"category-link mb-3\",onClick:()=>toggleDropdown(category.id),children:category.name}),dropdownOpen===category.id&&genresByCategory[category.id]&&/*#__PURE__*/_jsxs(\"ul\",{className:\"dropdown-menu show\",children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"dropdown-item\",onClick:()=>handleCategoryClick(category.id),children:[\"All \",category.name]})}),genresByCategory[category.id].map(genre=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"dropdown-item\",onClick:()=>handleGenreClick(genre.id),children:genre.name})},genre.id))]})]},category.id))})]});};export default FilterReviews;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","axios","isTokenValid","jsx","_jsx","jsxs","_jsxs","FilterReviews","categories","setCategories","genresByCategory","setGenresByCategory","navigate","dropdownOpen","setDropdownOpen","token","localStorage","getItem","fetchCategoriesAndGenres","categoriesResponse","get","headers","categoriesData","data","genresData","category","genresResponse","id","error","console","handleCategoryClick","categoryId","handleGenreClick","genreId","toggleDropdown","prevOpenId","className","children","map","onClick","name","genre"],"sources":["/Users/marcelotavares/Desktop/newBooks/newBooksFrontend/review-platform-frontend/src/components/Categories.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport \"../assets/css/Category_genre_filter.css\";\nimport { isTokenValid } from './Auth';\n\n\n/**\n * FilterReviews Component\n * \n * This component displays a list of categories and their associated genres, allowing users to filter reviews by category or genre.\n * It includes functionality to toggle genre dropdown menus for each category and navigate to filtered review pages.\n */\nconst FilterReviews = () => {\n  const [categories, setCategories] = useState([]); // Stores category data\n  const [genresByCategory, setGenresByCategory] = useState({}); // Stores genres organized by category\n  const navigate = useNavigate();\n  const [dropdownOpen, setDropdownOpen] = useState(null); // Stores the ID of the currently open dropdown or null if none\n\n  // Fetch categories and genres on component mount\n  useEffect(() => {\n    // Redirect to login if the token is invalid\n    if (!isTokenValid()) {\n      navigate('/api/login/');\n      return;\n    }\n\n    const token = localStorage.getItem('token');\n\n    // Async function to fetch categories and associated genres\n    const fetchCategoriesAndGenres = async () => {\n      try {\n        // Fetch categories\n        const categoriesResponse = await axios.get('/categories/', {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n          },\n        });\n        const categoriesData = categoriesResponse.data;\n        setCategories(categoriesData);\n\n        // Fetch genres for each category\n        const genresData = {};\n        for (const category of categoriesData) {\n          const genresResponse = await axios.get(`/categories/${category.id}/genres/`, {\n            headers: {\n              'Authorization': `Bearer ${token}`,\n            },\n          });\n          genresData[category.id] = genresResponse.data;\n        }\n        setGenresByCategory(genresData);\n      } catch (error) {\n        console.error('Error fetching categories and genres:', error); // Log errors for debugging\n      }\n    };\n\n    fetchCategoriesAndGenres();\n  }, [navigate]);\n\n  // Navigate to the category page\n  const handleCategoryClick = (categoryId) => {\n    navigate(`/reviews/category/${categoryId}`);\n  };\n\n  // Navigate to the genre page\n  const handleGenreClick = (genreId) => {\n    navigate(`/reviews/genre/${genreId}`);\n  };\n\n  // Toggle dropdown for genre list visibility\n  const toggleDropdown = (categoryId) => {\n    setDropdownOpen((prevOpenId) => (prevOpenId === categoryId ? null : categoryId));\n  };\n\n  return (\n    <div className=\"border border-secondary rounded p-3 text-center bk-color\">\n      <h3>Categories</h3>\n      <ul className=\"dropdown-list mt-3\">\n        {categories.map((category) => (\n          <li key={category.id}>\n            {/* Button to toggle dropdown for genres */}\n            <button\n              className=\"category-link mb-3\"\n              onClick={() => toggleDropdown(category.id)}\n            >\n              {category.name}\n            </button>\n\n            {/* Dropdown menu for genres */}\n            {dropdownOpen === category.id && genresByCategory[category.id] && (\n              <ul className=\"dropdown-menu show\">\n                <li>\n                  <button\n                    className=\"dropdown-item\"\n                    onClick={() => handleCategoryClick(category.id)}\n                  >\n                    All {category.name}\n                  </button>\n                </li>\n                {genresByCategory[category.id].map((genre) => (\n                  <li key={genre.id}>\n                    <button\n                      className=\"dropdown-item\"\n                      onClick={() => handleGenreClick(genre.id)}\n                    >\n                      {genre.name}\n                    </button>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default FilterReviews;\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}