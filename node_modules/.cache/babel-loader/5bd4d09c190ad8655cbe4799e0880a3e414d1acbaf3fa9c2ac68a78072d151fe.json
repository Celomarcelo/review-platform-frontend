{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{Link,useNavigate}from'react-router-dom';import{isTokenValid}from'./Auth';import'../assets/css/ReviewList_style.css';/**\n * ReviewList Component\n * \n * This component fetches and displays a list of book and movie reviews.\n * It checks for a valid token, fetches reviews, sorts them by creation date,\n * and handles any potential errors during the data fetching process.\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReviewList=()=>{const[reviews,setReviews]=useState([]);const[error,setError]=useState(null);const navigate=useNavigate();/**\n     * useEffect Hook\n     * \n     * Runs on component mount and handles token validation, fetches reviews,\n     * and sorts them by their creation date (newest first). Redirects the user\n     * to the login page if token validation fails or an error occurs.\n     */useEffect(()=>{const token=localStorage.getItem('token');// Retrieve the token from local storage\n// If the token is invalid, redirect to the login page\nif(!isTokenValid()){navigate('/api/login/');return;}// Fetch the reviews from the API\naxios.get('/api/reviews/',{headers:{'Authorization':`Bearer ${token}`}}).then(response=>{// Sort the reviews by creation date in descending order (newest first)\nconst sortedReviews=response.data.sort((a,b)=>new Date(b.created_at)-new Date(a.created_at));setReviews(sortedReviews);}).catch(error=>{// Handle any errors by setting an error message and redirecting to login\nsetError('Failed to fetch reviews. Please login again.');console.error(error);navigate('/api/login/');});},[navigate]);return/*#__PURE__*/ (// Render the list of reviews\n_jsxs(\"div\",{className:\"d-flex flex-column align-items-center mt-5\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Reviews\"}),error&&/*#__PURE__*/_jsx(\"p\",{className:\"text-danger\",children:error}),/*#__PURE__*/_jsx(\"ul\",{children:reviews.map(review=>/*#__PURE__*/_jsxs(\"li\",{className:\"mt-5 genre-list\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"review-container\",style:{position:'relative',margin:'auto'},children:[review.img&&/*#__PURE__*/_jsx(\"img\",{src:review.img,alt:review.title,className:\"img-fluid\",style:{maxWidth:'200px',height:'auto',display:'block',margin:'0 auto'}}),review.user&&review.user.profile_image&&/*#__PURE__*/_jsx(Link,{to:`/user/${review.user.id}/reviewsList`,children:/*#__PURE__*/_jsx(\"img\",{src:review.user.profile_image,alt:review.user.username,className:\"profile-image\",style:{position:'absolute',bottom:'5px',right:'70px',width:'70px',height:'70px',borderRadius:'50%',border:'2px solid white',objectFit:'cover',cursor:'pointer'}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2\",children:[/*#__PURE__*/_jsx(Link,{to:`/reviews/${review.id}`,children:review.title}),\" - \",review.author_director]})]},review.id))})]}));};export default ReviewList;","map":{"version":3,"names":["React","useEffect","useState","axios","Link","useNavigate","isTokenValid","jsx","_jsx","jsxs","_jsxs","ReviewList","reviews","setReviews","error","setError","navigate","token","localStorage","getItem","get","headers","then","response","sortedReviews","data","sort","a","b","Date","created_at","catch","console","className","children","map","review","style","position","margin","img","src","alt","title","maxWidth","height","display","user","profile_image","to","id","username","bottom","right","width","borderRadius","border","objectFit","cursor","author_director"],"sources":["/Users/marcelotavares/Desktop/newBooks/newBooksFrontend/review-platform-frontend/src/components/ReviewList.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { isTokenValid } from './Auth';\nimport '../assets/css/ReviewList_style.css';\n\n/**\n * ReviewList Component\n * \n * This component fetches and displays a list of book and movie reviews.\n * It checks for a valid token, fetches reviews, sorts them by creation date,\n * and handles any potential errors during the data fetching process.\n */\nconst ReviewList = () => {\n    const [reviews, setReviews] = useState([]);\n    const [error, setError] = useState(null);\n    const navigate = useNavigate();\n\n    /**\n     * useEffect Hook\n     * \n     * Runs on component mount and handles token validation, fetches reviews,\n     * and sorts them by their creation date (newest first). Redirects the user\n     * to the login page if token validation fails or an error occurs.\n     */\n    useEffect(() => {\n        const token = localStorage.getItem('token');  // Retrieve the token from local storage\n\n        // If the token is invalid, redirect to the login page\n        if (!isTokenValid()) {\n            navigate('/api/login/');\n            return;\n        }\n\n        // Fetch the reviews from the API\n        axios.get('/api/reviews/', {\n            headers: {\n                'Authorization': `Bearer ${token}`\n            }\n        })\n            .then(response => {\n                // Sort the reviews by creation date in descending order (newest first)\n                const sortedReviews = response.data.sort((a, b) => new Date(b.created_at) - new Date(a.created_at));\n                setReviews(sortedReviews);\n            })\n            .catch(error => {\n                // Handle any errors by setting an error message and redirecting to login\n                setError('Failed to fetch reviews. Please login again.');\n                console.error(error);\n                navigate('/api/login/');\n            });\n    }, [navigate]);\n\n    return (\n        // Render the list of reviews\n        <div className=\"d-flex flex-column align-items-center mt-5\">\n            <h1>Reviews</h1>\n            {/* Display error message if there's an error */}\n            {error && <p className=\"text-danger\">{error}</p>}\n            <ul>\n                {/* Map through the reviews array and render each review */}\n                {reviews.map(review => (\n                    <li key={review.id} className=\"mt-5 genre-list\">\n                        <div className=\"review-container\" style={{ position: 'relative', margin: 'auto' }}>\n                            {/* If the review has an image, display it */}\n                            {review.img && (\n                                <img\n                                    src={review.img}\n                                    alt={review.title}\n                                    className=\"img-fluid\"\n                                    style={{ maxWidth: '200px', height: 'auto', display: 'block', margin: '0 auto' }}\n                                />\n                            )}\n\n                            {/* Display the user profile picture at the bottom-right corner of the review image */}\n                            {review.user && review.user.profile_image && (\n                                <Link to={`/user/${review.user.id}/reviewsList`}>\n                                    <img\n                                        src={review.user.profile_image}\n                                        alt={review.user.username}\n                                        className=\"profile-image\"\n                                        style={{\n                                            position: 'absolute',\n                                            bottom: '5px',\n                                            right: '70px',\n                                            width: '70px',\n                                            height: '70px',\n                                            borderRadius: '50%',\n                                            border: '2px solid white',\n                                            objectFit: 'cover',\n                                            cursor: 'pointer'\n                                        }}\n                                    />\n                                </Link>\n                            )}\n                        </div>\n                        <div className='mt-2'>\n                            {/* Link to the detailed review page */}\n                            <Link to={`/reviews/${review.id}`}>{review.title}</Link> - {review.author_director}\n                        </div>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    );\n};\n\nexport default ReviewList;\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}