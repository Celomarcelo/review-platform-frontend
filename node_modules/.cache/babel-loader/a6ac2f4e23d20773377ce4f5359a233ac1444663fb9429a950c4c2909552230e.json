{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{useParams,useNavigate}from'react-router-dom';import{isTokenValid}from'./Auth';/**\n * UserReviewsList Component\n * \n * This component displays a list of reviews for a specific user. It also provides functionality \n * for users to favorite/not favorite the profile they are viewing, and shows details about the user.\n * \n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserReviewsList=()=>{const{userId}=useParams();const[user,setUser]=useState(null);const[reviews,setReviews]=useState([]);const[isFavorite,setIsFavorite]=useState(false);const[error,setError]=useState(null);const[loading,setLoading]=useState(true);const navigate=useNavigate();const token=localStorage.getItem('token');// Retrieve authentication token\nuseEffect(()=>{// Redirect to login if the token is invalid\nif(!isTokenValid()){navigate('/api/login/');return;}const fetchUserData=async()=>{try{// Fetch user profile data\nconst userResponse=await axios.get(`/user/${userId}/`,{headers:{Authorization:`Bearer ${token}`}});setUser(userResponse.data);// Fetch reviews created by the user\nconst reviewsResponse=await axios.get(`/user/${userId}/reviews/`,{headers:{Authorization:`Bearer ${token}`}});setReviews(reviewsResponse.data);// Fetch current user's favorites list to check if this user is already a favorite\nconst favoritesResponse=await axios.get(`/user/favorites/`,{headers:{Authorization:`Bearer ${token}`}});const favoritesList=favoritesResponse.data;setIsFavorite(favoritesList.some(fav=>fav.id.toString()===userId));setLoading(false);// Hide loading indicator once data is fetched\n}catch(error){console.error('Error fetching data:',error);setError('Failed to load data.');// Display error message if data fetch fails\nsetLoading(false);}};fetchUserData();// Fetch user data and reviews on component mount\n},[userId,token,navigate]);// Function to toggle the favorite status for the user\nconst toggleFavorite=async()=>{const loggedUserId=localStorage.getItem('userId');// Prevent users from favoriting themselves\nif(!loggedUserId||!userId||loggedUserId.toString()===userId.toString()){alert('You cannot favorite yourself.');return;}try{const response=await axios.post(`/user/${userId}/toggle-favorite/`,{},{headers:{Authorization:`Bearer ${token}`}});alert(response.data.message);// Display success message\nsetIsFavorite(!isFavorite);// Toggle favorite status\nwindow.location.reload();// Refresh page to update favorite status\n}catch(error){console.error('Error favoriting user:',error);setError('Failed to update favorites.');}};// Render loading indicator if data is being fetched\nif(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}// Render error message if an error occurred\nif(error){return/*#__PURE__*/_jsx(\"div\",{children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-column align-items-center my-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex align-items-center mb-4 mt-5\",children:user.profile_image&&/*#__PURE__*/_jsx(\"img\",{src:user.profile_image// Display user's profile image if available\n,alt:\"User Profile\",className:\"rounded-circle\",style:{width:'100px',height:'100px',objectFit:'cover',marginRight:'15px'}})}),/*#__PURE__*/_jsx(\"h1\",{children:user.username}),/*#__PURE__*/_jsx(\"p\",{children:user.biography?user.biography:\"Biography not available\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary btn-lg mt-3\",onClick:toggleFavorite,children:isFavorite?'Not favorite':'Favorite'}),/*#__PURE__*/_jsx(\"h2\",{className:\"mt-5\",children:\"Reviews\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-unstyled\",children:reviews.length>0?reviews.map(review=>/*#__PURE__*/_jsxs(\"li\",{className:\"mb-4 mt-5\",children:[review.img&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center mb-2 mt-5\",children:/*#__PURE__*/_jsx(\"img\",{src:review.img,alt:review.title,className:\"img-fluid\",style:{maxWidth:'200px',height:'auto'}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h4\",{children:review.title}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Author/Director:\"}),\" \",review.author_director]}),/*#__PURE__*/_jsx(\"p\",{children:review.content}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Genre:\"}),\" \",review.genre_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Rating:\"}),\" \",review.rating,\"/5\"]})]})]},review.id)):/*#__PURE__*/_jsx(\"p\",{children:\"No reviews found.\"})// Message if the user has no reviews\n})]});};export default UserReviewsList;","map":{"version":3,"names":["React","useEffect","useState","axios","useParams","useNavigate","isTokenValid","jsx","_jsx","jsxs","_jsxs","UserReviewsList","userId","user","setUser","reviews","setReviews","isFavorite","setIsFavorite","error","setError","loading","setLoading","navigate","token","localStorage","getItem","fetchUserData","userResponse","get","headers","Authorization","data","reviewsResponse","favoritesResponse","favoritesList","some","fav","id","toString","console","toggleFavorite","loggedUserId","alert","response","post","message","window","location","reload","children","className","profile_image","src","alt","style","width","height","objectFit","marginRight","username","biography","onClick","length","map","review","img","title","maxWidth","author_director","content","genre_name","rating"],"sources":["/Users/marcelotavares/Desktop/newBooks/newBooksFrontend/review-platform-frontend/src/components/UserReviewsList.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { isTokenValid } from './Auth';\n\n/**\n * UserReviewsList Component\n * \n * This component displays a list of reviews for a specific user. It also provides functionality \n * for users to favorite/not favorite the profile they are viewing, and shows details about the user.\n * \n */\n\nconst UserReviewsList = () => {\n    const { userId } = useParams();\n    const [user, setUser] = useState(null);\n    const [reviews, setReviews] = useState([]);\n    const [isFavorite, setIsFavorite] = useState(false);\n    const [error, setError] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const navigate = useNavigate();\n\n    const token = localStorage.getItem('token');  // Retrieve authentication token\n\n    useEffect(() => {\n        // Redirect to login if the token is invalid\n        if (!isTokenValid()) {\n            navigate('/api/login/');\n            return;\n        }\n        const fetchUserData = async () => {\n            try {\n                // Fetch user profile data\n                const userResponse = await axios.get(`/user/${userId}/`, {\n                    headers: { Authorization: `Bearer ${token}` },\n                });\n                setUser(userResponse.data);\n\n                // Fetch reviews created by the user\n                const reviewsResponse = await axios.get(`/user/${userId}/reviews/`, {\n                    headers: { Authorization: `Bearer ${token}` },\n                });\n                setReviews(reviewsResponse.data);\n\n                // Fetch current user's favorites list to check if this user is already a favorite\n                const favoritesResponse = await axios.get(`/user/favorites/`, {\n                    headers: { Authorization: `Bearer ${token}` },\n                });\n                const favoritesList = favoritesResponse.data;\n                setIsFavorite(favoritesList.some(fav => fav.id.toString() === userId));\n\n                setLoading(false);  // Hide loading indicator once data is fetched\n            } catch (error) {\n                console.error('Error fetching data:', error);\n                setError('Failed to load data.');  // Display error message if data fetch fails\n                setLoading(false);\n            }\n        };\n\n        fetchUserData();  // Fetch user data and reviews on component mount\n    }, [userId, token, navigate]);\n\n    // Function to toggle the favorite status for the user\n    const toggleFavorite = async () => {\n        const loggedUserId = localStorage.getItem('userId');\n\n        // Prevent users from favoriting themselves\n        if (!loggedUserId || !userId || loggedUserId.toString() === userId.toString()) {\n            alert('You cannot favorite yourself.');\n            return;\n        }\n\n        try {\n            const response = await axios.post(`/user/${userId}/toggle-favorite/`, {}, {\n                headers: { Authorization: `Bearer ${token}` },\n            });\n\n            alert(response.data.message);  // Display success message\n            setIsFavorite(!isFavorite);  // Toggle favorite status\n            window.location.reload();  // Refresh page to update favorite status\n        } catch (error) {\n            console.error('Error favoriting user:', error);\n            setError('Failed to update favorites.');\n        }\n    };\n\n    // Render loading indicator if data is being fetched\n    if (loading) {\n        return <div>Loading...</div>;\n    }\n\n    // Render error message if an error occurred\n    if (error) {\n        return <div>{error}</div>;\n    }\n\n    return (\n        <div className=\"d-flex flex-column align-items-center my-5\">\n            {/* User profile section */}\n            <div className=\"d-flex align-items-center mb-4 mt-5\">\n                {user.profile_image && (\n                    <img\n                        src={user.profile_image}  // Display user's profile image if available\n                        alt=\"User Profile\"\n                        className=\"rounded-circle\"\n                        style={{ width: '100px', height: '100px', objectFit: 'cover', marginRight: '15px' }}\n                    />\n                )}\n            </div>\n            <h1>{user.username}</h1>\n            <p>{user.biography ? user.biography : \"Biography not available\"}</p>\n\n            {/* Favorite/Unfavorite button */}\n            <button className=\"btn btn-primary btn-lg mt-3\" onClick={toggleFavorite}>\n                {isFavorite ? 'Not favorite' : 'Favorite'}\n            </button>\n\n            {/* User's reviews section */}\n            <h2 className=\"mt-5\">Reviews</h2>\n            <ul className=\"list-unstyled\">\n                {reviews.length > 0 ? (\n                    reviews.map((review) => (\n                        <li key={review.id} className=\"mb-4 mt-5\">\n                            {/* Display review image if available */}\n                            {review.img && (\n                                <div className=\"d-flex justify-content-center mb-2 mt-5\">\n                                    <img\n                                        src={review.img}\n                                        alt={review.title}\n                                        className=\"img-fluid\"\n                                        style={{ maxWidth: '200px', height: 'auto' }}\n                                    />\n                                </div>\n                            )}\n                            {/* Review details */}\n                            <div className=\"text-center\">\n                                <h4>{review.title}</h4>\n                                <p><strong>Author/Director:</strong> {review.author_director}</p>\n                                <p>{review.content}</p>\n                                <p><strong>Genre:</strong> {review.genre_name}</p>\n                                <p><strong>Rating:</strong> {review.rating}/5</p>\n                            </div>\n                        </li>\n                    ))\n                ) : (\n                    <p>No reviews found.</p>  // Message if the user has no reviews\n                )}\n            </ul>\n        </div>\n    );\n};\n\nexport default UserReviewsList;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}